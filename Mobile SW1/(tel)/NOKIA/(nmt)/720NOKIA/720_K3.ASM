LIST P=16C84		;load\save with reset for N-720
;

COMWRIN		EQU 	B'10100000'
COMRDIN		EQU	B'10100001'
ADRIN1		EQU	B'10110000'
ADRIN2		EQU	B'10110001'
ADRIN3		EQU	B'10110010'
ADRIN4		EQU	B'10110011'
ADRIN5		EQU	B'10110100'
ADRIN6		EQU	B'10110101'

COMWROUT	EQU	B'10101100'
ADDR1		EQU	0D1h			;B'11001101'
ADDR2		EQU	0D2h			;B'11001110'
ADDR3		EQU	0D3h			;B'11001111'
ADDR4		EQU	0D4h			;B'11010000'
ADDR5		EQU	0D5h
ADDR6		EQU	0D6h


STATUS		EQU	03h
PORTB		EQU	06h
TRISB		EQU	06h

REB		EQU	0Ch
WRB		EQU	0Dh
CNTCIKL		EQU	0Eh
TIME		EQU	0Fh
TIME2		EQU	10H

DATA1		EQU	11h
DATA2		EQU	12h
DATA3		EQU	13h
DATA4		EQU	14h
DATA5		EQU	15h
DATA6		EQU	16h

;
	ORG	0
	CLRF	PORTB
	CALL	CLDRESE
	CALL	TM
	CALL	TM

READ1	CALL	TM
	CALL	START
	MOVLW	COMWRIN
	MOVWF	WRB
	CALL	OUTI2C
	MOVLW	ADRIN1
	MOVWF	WRB
	CALL	OUTI2C
	CALL	START
	MOVLW	COMRDIN
	MOVWF	WRB
	CALL	OUTI2C
	CALL	INI2C
	MOVF	REB,0
;	XORLW	0FFh
;	BTFSC	STATUS,2	
;	GOTO	READ1
;	MOVF	REB,0
	MOVWF	DATA1

READ2	CALL	TM
	CALL	START
	MOVLW	COMWRIN
	MOVWF	WRB
	CALL	OUTI2C
	MOVLW	ADRIN2
	MOVWF	WRB
	CALL	OUTI2C
	CALL	START
	MOVLW	COMRDIN
	MOVWF	WRB
	CALL	OUTI2C
	CALL	INI2C
;	MOVF	REB,0
;	XORLW	0FFh
;	BTFSC	STATUS,2	
;	GOTO	READ2
	MOVF	REB,0
	MOVWF	DATA2

READ3	CALL	TM
	CALL	START
	MOVLW	COMWRIN
	MOVWF	WRB
	CALL	OUTI2C
	MOVLW	ADRIN3
	MOVWF	WRB
	CALL	OUTI2C
	CALL	START
	MOVLW	COMRDIN
	MOVWF	WRB
	CALL	OUTI2C
	CALL	INI2C
;	MOVF	REB,0
;	XORLW	0FFh
;	BTFSC	STATUS,2	
;	GOTO	READ3
	MOVF	REB,0
	MOVWF	DATA3

READ4	CALL	TM
	CALL	START
	MOVLW	COMWRIN
	MOVWF	WRB
	CALL	OUTI2C
	MOVLW	ADRIN4
	MOVWF	WRB
	CALL	OUTI2C
	CALL	START
	MOVLW	COMRDIN
	MOVWF	WRB
	CALL	OUTI2C
	CALL	INI2C
;	MOVF	REB,0
;	XORLW	0FFh
;	BTFSC	STATUS,2	
;	GOTO	READ4
	MOVF	REB,0
	MOVWF	DATA4

READ5	CALL	TM
	CALL	START
	MOVLW	COMWRIN
	MOVWF	WRB
	CALL	OUTI2C
	MOVLW	ADRIN5
	MOVWF	WRB
	CALL	OUTI2C
	CALL	START
	MOVLW	COMRDIN
	MOVWF	WRB
	CALL	OUTI2C
	CALL	INI2C
;	MOVF	REB,0
;	XORLW	0FFh
;	BTFSC	STATUS,2	
;	GOTO	READ5
	MOVF	REB,0
	MOVWF	DATA5

READ6	CALL	TM
	CALL	START
	MOVLW	COMWRIN
	MOVWF	WRB
	CALL	OUTI2C
	MOVLW	ADRIN6
	MOVWF	WRB
	CALL	OUTI2C
	CALL	START
	MOVLW	COMRDIN
	MOVWF	WRB
	CALL	OUTI2C
	CALL	INI2C
;	MOVF	REB,0
;	XORLW	0FFh
;	BTFSC	STATUS,2	
;	GOTO	READ6
	MOVF	REB,0
	MOVWF	DATA6

;	CALL	INI2C
;	MOVF	REB,0
;	MOVWF	DATA2
;	CALL	INI2C
;	MOVF	REB,0
;	MOVWF	DATA3
;	CALL	INI2C
;	MOVF	REB,0
;	MOVWF	DATA4
;	CALL	INI2C
;	MOVF	REB,0
;	MOVWF	DATA5
;	CALL	INI2C
;	MOVF	REB,0
;	MOVWF	DATA6
;	CALL	STOP
	CALL	TM


;	MOVLW	12H
;	MOVWF	DATA1
;	MOVLW	34H
;	MOVWF	DATA2
;	MOVLW	56H
;	MOVWF	DATA3
;	MOVLW	70H
;	MOVWF	DATA4
;	MOVLW	08H
;	MOVWF	DATA5
;	MOVLW	9AH
;	MOVWF	DATA6

;	CALL	TM
	CALL	START
	MOVLW	COMWROUT		
	MOVWF	WRB
	CALL	OUTI2C
	MOVLW	ADDR1
	MOVWF	WRB
	CALL	OUTI2C
	MOVF	DATA1,0
	MOVWF	WRB
	CALL	OUTI2C
	CALL	STOP

	CALL	TM
	CALL	START
	MOVLW	COMWROUT		
	MOVWF	WRB
	CALL	OUTI2C
	MOVLW	ADDR1
	MOVWF	WRB
	CALL	OUTI2C
	MOVF	DATA1,0
	MOVWF	WRB
	CALL	OUTI2C
	CALL	STOP

	CALL	TM

	CALL	START
	MOVLW	COMWROUT		
	MOVWF	WRB
	CALL	OUTI2C
	MOVLW	ADDR2
	MOVWF	WRB
	CALL	OUTI2C
	MOVF	DATA2,0
	MOVWF	WRB
	CALL	OUTI2C
	CALL	STOP

	CALL	TM

	CALL	START
	MOVLW	COMWROUT		
	MOVWF	WRB
	CALL	OUTI2C
	MOVLW	ADDR3
	MOVWF	WRB
	CALL	OUTI2C
	MOVF	DATA3,0
	MOVWF	WRB
	CALL	OUTI2C
	CALL	STOP
	
	CALL	TM

	CALL	START
	MOVLW	COMWROUT		
	MOVWF	WRB
	CALL	OUTI2C
	MOVLW	ADDR4
	MOVWF	WRB
	CALL	OUTI2C
	MOVF	DATA4,0
	MOVWF	WRB
	CALL	OUTI2C
	CALL	STOP

	CALL	START
	MOVLW	COMWROUT		
	MOVWF	WRB
	CALL	OUTI2C
	MOVLW	ADDR1
	MOVWF	WRB
	CALL	OUTI2C
	MOVF	DATA1,0
	MOVWF	WRB
	CALL	OUTI2C
	CALL	STOP

	CALL	TM

	CALL	START
	MOVLW	COMWROUT		
	MOVWF	WRB
	CALL	OUTI2C
	MOVLW	ADDR2
	MOVWF	WRB
	CALL	OUTI2C
	MOVF	DATA2,0
	MOVWF	WRB
	CALL	OUTI2C
	CALL	STOP

	CALL	TM

	CALL	START
	MOVLW	COMWROUT		
	MOVWF	WRB
	CALL	OUTI2C
	MOVLW	ADDR3
	MOVWF	WRB
	CALL	OUTI2C
	MOVF	DATA3,0
	MOVWF	WRB
	CALL	OUTI2C
	CALL	STOP
	
	CALL	TM

	CALL	START
	MOVLW	COMWROUT		
	MOVWF	WRB
	CALL	OUTI2C
	MOVLW	ADDR4
	MOVWF	WRB
	CALL	OUTI2C
	MOVF	DATA4,0
	MOVWF	WRB
	CALL	OUTI2C
	CALL	STOP

	CALL	TM

	CALL	START
	MOVLW	COMWROUT		
	MOVWF	WRB
	CALL	OUTI2C
	MOVLW	ADDR5
	MOVWF	WRB
	CALL	OUTI2C
	MOVF	DATA5,0
	MOVWF	WRB
	CALL	OUTI2C
	CALL	STOP

	CALL	TM

	CALL	START
	MOVLW	COMWROUT		
	MOVWF	WRB
	CALL	OUTI2C
	MOVLW	ADDR6
	MOVWF	WRB
	CALL	OUTI2C
	MOVF	DATA6,0
	MOVWF	WRB
	CALL	OUTI2C
	CALL	STOP

	CALL	TM
	CALL	SETRESE
	GOTO	$
;--------------------------------------------------------------MAIN

OUTI2C	MOVLW	8
	MOVWF	CNTCIKL
CONOUT	BTFSC	WRB,7
	CALL	SETDAT
	CALL	TM
	CALL	SETSTR
	CALL	TM	
	CALL	CLDSTR
	CALL	TM
	CALL	CLDDAT
	RLF	WRB,1
	DECFSZ	CNTCIKL,1
	GOTO	CONOUT
	
	CALL	SETDAT
	CALL	TM
	CALL	SETSTR
	CALL	TM	
	CALL	CLDSTR
	CALL	TM
	CALL	CLDDAT
	CALL	TM
	RETURN
;--------OUT-------------------------------------------------OUT----------
INI2C	CLRF	REB
	MOVLW	8
	MOVWF	CNTCIKL
	CALL	SETDAT
	CALL	TM
	
CONIN	RLF	REB,1
	CALL	SETSTR
	CALL	TM
	BTFSC	PORTB,1
	BSF	REB,0		;WRITE LOW BIT TO REB
	CALL	CLDSTR
	CALL	TM
	DECFSZ	CNTCIKL,1
	GOTO	CONIN
	CALL	CLDDAT
	CALL	TM
	CALL	SETSTR	
	CALL	TM
	CALL	CLDSTR
	CALL	TM
	RETURN
;----------------IN------------------------------------------------IN-------
SETSTR	MOVLW	32
	MOVWF	STATUS
	BSF	TRISB,0
	MOVLW	0
	MOVWF	STATUS
	RETURN

CLDSTR	MOVLW	32
	MOVWF	STATUS
	BCF	TRISB,0
	MOVLW	0
	MOVWF	STATUS
	RETURN

SETDAT	MOVLW	32
	MOVWF	STATUS
	BSF	TRISB,1
	MOVLW	0
	MOVWF	STATUS
	RETURN

CLDDAT	MOVLW	32
	MOVWF	STATUS
	BCF	TRISB,1
	MOVLW	0
	MOVWF	STATUS
	RETURN

SETRESE	MOVLW	32
	MOVWF	STATUS
	BSF	TRISB,2
	BSF	TRISB,3
	MOVLW	0
	MOVWF	STATUS
	RETURN

CLDRESE	MOVLW	32
	MOVWF	STATUS
	BCF	TRISB,2
	BCF	TRISB,3
	MOVLW	0
	MOVWF	STATUS
	RETURN


;-----------------PORT-------------------------------------------------------
;BEGIN	CALL	TMLONG
;	CALL	TMLONG
;	CALL	TMLONG
;	CALL	TMLONG
;	CALL	TMLONG
;	CALL	TMLONG
;	CALL	TMLONG
;	CALL	TMLONG
;	CALL	TMLONG
;	CALL	TMLONG
;BEGI	CALL	TMLONG
;
;	MOVLW	0FFh
;	MOVWF	CNTCIKL
;CONBEG	CALL	TM
;	CALL	TM
;	BTFSC	PORTB,2
;	GOTO	BEGI
;	DECFSZ	CNTCIKL,1
;	GOTO	CONBEG
;	CALL	RESET
;	RETURN
;-------------------BEGIN----------------------------------------------------
START	CALL	SETDAT
	CALL	TM
	CALL	SETSTR
	CALL	TM
	CALL	CLDDAT
	CALL	TM
	CALL	CLDSTR
	CALL	TM
	RETURN
;-------------------START---------------------------------------------------
STOP	CALL	SETSTR
	CALL	TM
	CALL	SETDAT
	CALL	TM
	RETURN
;---------------------STOP---------------------------------------------------	
TM	MOVLW	09Fh
	MOVWF	TIME
LL3	DECFSZ	TIME,1
	GOTO	LL3
	RETURN
;----------------------TM----------------------------------------------------


TMLONG	MOVLW	0FH
	MOVWF	TIME
LL1	MOVLW	05FH
	MOVWF	TIME2
LL2	DECFSZ	TIME2,1
	GOTO	LL2	

	DECFSZ	TIME,1
	GOTO	LL1
	RETURN	
;----------------------TMLONG-----------------------------------------------
end
;          
